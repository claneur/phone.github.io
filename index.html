<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CyberAware – Sensibilisation</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="wrapper">

  <!-- LOGIN -->
  <section id="loginSection" class="card">
    <h1>CyberAware</h1>
    <p>Plateforme de sensibilisation à la cybersécurité</p>
    <input type="email" id="email" placeholder="Adresse email" required>
    <input type="password" id="password" placeholder="Mot de passe" required>
    <button onclick="register()">Continuer</button>
  </section>

  <!-- CODE -->
  <section id="codeSection" class="card hidden">
    <h2>Vérification</h2>
    <p>Entrez le code de validation (simulation)</p>
    <p class="demo">Code généré : <span id="generatedCode"></span></p>
    <input type="text" id="codeInput" placeholder="Code">
    <button onclick="verifyCode()">Valider</button>
  </section>

  <!-- DASHBOARD -->
  <section id="dashboard" class="hidden">

    <h2 class="center">Techniques d'attaque – Vue éducative</h2>

    <div class="grid">
      <div class="card">
        <h3>Phishing</h3>
        <p>
          Le phishing imite des services connus pour tromper l'utilisateur et récupérer des informations sensibles.
        </p>
      </div>

      <div class="card">
        <h3>Ingénierie sociale</h3>
        <p>
          Exploitation psychologique des biais humains : urgence, peur, autorité.
        </p>
      </div>

      <div class="card">
        <h3>Fausses interfaces</h3>
        <p>
          Pages imitant visuellement des sites connus. La vigilance est la clé.
        </p>
      </div>

      <div class="card">
        <h3>Compromission de session</h3>
        <p>
          Accès non autorisé à une session active via un appareil ou réseau non sécurisé.
        </p>
      </div>
    </div>

    <!-- CONTACT -->
    <h2 class="center">Contact</h2>

    <form id="contactForm" class="card">
      <input type="text" name="name" placeholder="Nom" required>
      <input type="email" name="email" placeholder="Email" required>
      <textarea name="message" placeholder="Message" required></textarea>

      <!-- Options FormSubmit -->
      <input type="hidden" name="_captcha" value="false">
      <input type="hidden" name="_subject" value="Nouveau message CyberAware">
      <input type="hidden" name="_template" value="table">
      <input type="hidden" name="_next" value="">

      <button type="submit">Envoyer</button>
      <p id="status"></p>
    </form>

    <p class="legal">
      ⚠️ Site éducatif – aucune méthode illégale n'est enseignée.
    </p>

  </section>

</div>

<script src="script.js"></script>

<!-- Script formulaire FormSubmit -->
<script>
document.getElementById("contactForm").addEventListener("submit", function(e) {
  e.preventDefault();
  
  const statusEl = document.getElementById("status");
  statusEl.innerText = "Envoi en cours...";
  statusEl.style.color = "#666";
  
  const formData = new FormData(this);
  
  // Définir l'URL de redirection (page actuelle)
  formData.set('_next', window.location.href + '?success=true');
  
  // Méthode 1 : Tentative AJAX
  fetch("https://formsubmit.co/ajax/tss.alex84@gmail.com", {
    method: "POST",
    headers: {
      'Content-Type': 'application/json',
      'Accept': 'application/json'
    },
    body: JSON.stringify({
      name: formData.get('name'),
      email: formData.get('email'),
      message: formData.get('message'),
      _captcha: "false",
      _subject: "Nouveau message CyberAware",
      _template: "table"
    })
  })
  .then(response => {
    if (!response.ok) {
      throw new Error('Mode AJAX non activé, utilisation du mode classique');
    }
    return response.json();
  })
  .then(data => {
    statusEl.innerText = "Message envoyé avec succès ✅";
    statusEl.style.color = "green";
    this.reset();
  })
  .catch(error => {
    // Si l'AJAX échoue, utiliser la soumission classique
    console.log('Utilisation de la méthode de soumission classique');
    
    const tempForm = document.createElement('form');
    tempForm.action = "https://formsubmit.co/tss.alex84@gmail.com";
    tempForm.method = "POST";
    tempForm.style.display = "none";
    
    // Copier tous les champs
    formData.forEach((value, key) => {
      const input = document.createElement('input');
      input.type = 'hidden';
      input.name = key;
      input.value = value;
      tempForm.appendChild(input);
    });
    
    document.body.appendChild(tempForm);
    tempForm.submit();
  });
});

// Vérifier si on revient après succès
window.addEventListener('DOMContentLoaded', function() {
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('success') === 'true') {
    const statusEl = document.getElementById("status");
    if (statusEl) {
      statusEl.innerText = "Message envoyé avec succès ✅";
      statusEl.style.color = "green";
    }
    // Nettoyer l'URL
    window.history.replaceState({}, document.title, window.location.pathname);
  }
});
</script>

</body>
</html>
